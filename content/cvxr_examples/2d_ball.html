---
title: Largest Ball in a Polyhedron in 2D
author: Anqi Fu and Balasubramanian Narasimhan
date: '2017-11-02'
slug: cvxr_2d_ball
bibliography: ../bibtex/cvxr_refs.bib
link-citations: true
categories: []
tags: []
params:
  mode: ignore
  testdata_dir: test_data
  data_dir: 2d_ball
---



<div id="problem" class="section level2">
<h2>Problem</h2>
<p>The following is a problem from <span class="citation">Boyd and Vandenberghe (<a href="#ref-BoydVandenberghe:2004" role="doc-biblioref">2004</a>)</span>, section 4.3.1.</p>
<p>Find the largest Euclidean ball (i.e.Â its center and radius) that lies
in a polyhedron described by affine inequalites:</p>
<p><span class="math display">\[
P = {x : a_i&#39;*x &lt;= b_i, i=1,...,m} 
\]</span></p>
<p>where x is in <span class="math inline">\({\mathbf R}^2\)</span>.</p>
<p>We define variables that determine the polyhedron.</p>
<pre class="r"><code>a1 &lt;- matrix(c(2,1))
a2 &lt;- matrix(c(2,-1))
a3 &lt;- matrix(c(-1,2))
a4 &lt;- matrix(c(-1,-2))
b &lt;- rep(1,4)</code></pre>
<p>Next, we formulate the <code>CVXR</code> problem.</p>
<pre class="r"><code>r &lt;- Variable(name = &quot;radius&quot;)
x_c &lt;- Variable(2, name = &quot;center&quot;)
obj &lt;- Maximize(r)
constraints &lt;- list(
    t(a1) %*% x_c + p_norm(a1, 2) * r &lt;= b[1],
    t(a2) %*% x_c + p_norm(a2, 2) * r &lt;= b[2],
    t(a3) %*% x_c + p_norm(a3, 2) * r &lt;= b[3],
    t(a4) %*% x_c + p_norm(a4, 2) * r &lt;= b[4]
)
p &lt;- Problem(obj, constraints)</code></pre>
<p>All that remains is to solve the problem and read off the solution.</p>
<pre class="r"><code>result &lt;- solve(p)
radius &lt;- result$getValue(r)
center &lt;- result$getValue(x_c)
cat(sprintf(&quot;The radius is %0.5f for an area %0.5f\n&quot;, radius, pi * radius^2))    </code></pre>
<pre><code>## The radius is 0.44721 for an area 0.62832</code></pre>
</div>
<div id="a-plot" class="section level2">
<h2>A Plot</h2>
<pre class="r"><code>ggplot() +
    geom_abline(slope = -a1[1] / a1[2], intercept = b[1] / a1[2]) +
    geom_abline(slope = -a2[1] / a2[2], intercept = b[2] / a2[2]) +
    geom_abline(slope = -a3[1] / a3[2], intercept = b[3] / a3[2]) +
    geom_abline(slope = -a4[1] / a4[2], intercept = b[4] / a4[2]) +
    geom_circle(mapping = aes(x0 = center[1], y0 = center[2], r = radius), color = &quot;blue&quot;) +
    geom_point(mapping = aes(x = center[1], y = center[2]), color = &quot;red&quot;, size = 2) +
    geom_line(mapping = aes(x = c(center[1], center[1] - radius), y = c(center[2], center[2])),
              arrow = arrow(length = unit(0.03, &quot;npc&quot;), ends = &quot;first&quot;, type = &quot;closed&quot;),
              color = &quot;brown&quot;) +
    annotate(&quot;text&quot;, x = -0.2, y = 0.04, label = sprintf(&quot;r = %0.5f&quot;, radius)) +
    labs(x = &quot;x&quot;, y = &quot;y&quot;) +
    xlim(-1, 1) + ylim(-1, 1)</code></pre>
<p><img src="/cvxr_examples/2d_ball_files/figure-html/unnamed-chunk-6-1.png" width="576" /></p>
</div>
<div id="session-info" class="section level2">
<h2>Session Info</h2>
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>## R version 3.6.2 (2019-12-12)
## Platform: x86_64-apple-darwin19.2.0 (64-bit)
## Running under: macOS Catalina 10.15.2
## 
## Matrix products: default
## BLAS/LAPACK: /usr/local/Cellar/openblas/0.3.7/lib/libopenblasp-r0.3.7.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices datasets  utils     methods   base     
## 
## other attached packages:
## [1] ggforce_0.3.1 ggplot2_3.2.1 CVXR_1.0     
## 
## loaded via a namespace (and not attached):
##  [1] gmp_0.5-13.5      Rcpp_1.0.3        compiler_3.6.2    pillar_1.4.3     
##  [5] R.methodsS3_1.7.1 R.utils_2.9.2     tools_3.6.2       digest_0.6.23    
##  [9] bit_1.1-14        evaluate_0.14     lifecycle_0.1.0   tibble_2.1.3     
## [13] gtable_0.3.0      lattice_0.20-38   pkgconfig_2.0.3   rlang_0.4.2      
## [17] Matrix_1.2-18     gurobi_9.0-0      Rglpk_0.6-4       yaml_2.2.0       
## [21] blogdown_0.17     xfun_0.11         osqp_0.6.0.3      withr_2.1.2      
## [25] dplyr_0.8.3       Rmpfr_0.7-2       stringr_1.4.0     knitr_1.26       
## [29] tidyselect_0.2.5  bit64_0.9-7       grid_3.6.2        glue_1.3.1       
## [33] R6_2.4.1          rmarkdown_2.0     bookdown_0.16     polyclip_1.10-0  
## [37] farver_2.0.1      tweenr_1.0.1      purrr_0.3.3       magrittr_1.5     
## [41] MASS_7.3-51.5     scales_1.1.0      htmltools_0.4.0   assertthat_0.2.1 
## [45] colorspace_1.4-1  labeling_0.3      Rcplex_0.3-3      stringi_1.4.3    
## [49] Rmosek_9.1.0      lazyeval_0.2.2    munsell_0.5.0     slam_0.1-47      
## [53] crayon_1.3.4      R.oo_1.23.0</code></pre>
</div>
<div id="source" class="section level2">
<h2>Source</h2>
<p><a href="https://github.com/bnaras/cvxr_docs/blob/master/content/cvxr_examples/2d_ball.Rmd">R Markdown</a></p>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-BoydVandenberghe:2004">
<p>Boyd, S., and L. Vandenberghe. 2004. <em>Convex Optimization</em>. Cambridge University Press.</p>
</div>
</div>
</div>
