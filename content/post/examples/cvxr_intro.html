---
title: Introduction
author: Anqi Fu and Balasubramanian Narasimhan
date: '2017-10-29'
categories:
  - Simple Least Squares
slug: cvxr_intro
---



<p>Consider a simple linear regression problem where it is desired to
estimate a set of parameters using a least squares criterion.</p>
<p>We generate some synthetic data where we know the model completely,
that is</p>
<p><span class="math display">\[ Y = X\beta + \epsilon \]</span></p>
<p>where <span class="math inline">\(Y\)</span> is a <span class="math inline">\(100\times 1\)</span> vector, <span class="math inline">\(X\)</span> is a <span class="math inline">\(100\times 10\)</span> matrix,
<span class="math inline">\(\beta = [-4,\ldots ,-1, 0, 1, \ldots, 5]\)</span> is a <span class="math inline">\(10\times 1\)</span> vector, and
<span class="math inline">\(\epsilon \sim N(0, 1)\)</span>.</p>
<pre class="r"><code>set.seed(123)

n &lt;- 100
p &lt;- 10
beta &lt;- -4:5   # beta is just -4 through 5.

X &lt;- matrix(rnorm(n * p), nrow=n)
colnames(X) &lt;- paste0(&quot;beta_&quot;, beta)
Y &lt;- X %*% beta + rnorm(n)</code></pre>
<p>Given the data <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, we can estimate the <span class="math inline">\(\beta\)</span> vector using
<code>lm</code> function in R that fits a standard regression model.</p>
<pre class="r"><code>ls.model &lt;- lm(Y ~ 0 + X)   # There is no intercept in our model above
m &lt;- matrix(coef(ls.model), ncol = 1)
rownames(m) &lt;- paste0(&quot;$\\beta_{&quot;, 1:p, &quot;}$&quot;)
library(kableExtra)
knitr::kable(m, format = &quot;html&quot;) %&gt;%
    kable_styling(&quot;striped&quot;) %&gt;%
    column_spec(1:2, background = &quot;#ececec&quot;)</code></pre>
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{1}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
-3.9196886
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{2}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
-3.0117048
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{3}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
-2.1248242
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{4}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
-0.8666048
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{5}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
0.0914658
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{6}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
0.9490454
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{7}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
2.0764700
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{8}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
3.1272275
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{9}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
3.9609565
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{10}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
5.1348845
</td>
</tr>
</tbody>
</table>
<p>These are the least-squares estimates and can be seen to be reasonably
close to the original <span class="math inline">\(\beta\)</span> values -4 through 5.</p>
<div id="the-cvxr-formulation" class="section level2">
<h2>The <code>CVXR</code> formulation</h2>
<p>The <code>CVXR</code> formulation states the above as an optimization problem:</p>
<p><span class="math display">\[
  \begin{array}{ll}
    \underset{\beta}{\mbox{minimize}} &amp; \|y - X\beta\|_2^2,
  \end{array}
\]</span>
which directly translates into a problem that <code>CVXR</code> can solve as shown
in the steps below.</p>
<ul>
<li>Step 0. Load the <code>CVXR</code> library</li>
</ul>
<pre class="r"><code>suppressWarnings(library(CVXR, warn.conflicts=FALSE))</code></pre>
<ul>
<li>Step 1. Define the variable to be estimated</li>
</ul>
<pre class="r"><code>betaHat &lt;- Variable(p)</code></pre>
<ul>
<li>Step 2. Define the objective to be optimized</li>
</ul>
<pre class="r"><code>objective &lt;- Minimize(sum((Y - X %*% betaHat)^2))</code></pre>
<p>Notice how the objective is specified using functions such as <code>sum</code>,
<code>*%*</code> and <code>^</code>, that are familiar to R users despite that fact that
<code>betaHat</code> is no ordinary R expression but a <code>CVXR</code> expression.</p>
<ul>
<li>Step 3. Create a problem to solve</li>
</ul>
<pre class="r"><code>problem &lt;- Problem(objective)</code></pre>
<ul>
<li>Step 4. Solve it!</li>
</ul>
<pre class="r"><code>result &lt;- solve(problem)</code></pre>
<ul>
<li>Step 5. Extract solution and objective value</li>
</ul>
<pre><code>## Objective value: 97.847586</code></pre>
<p>We can indeed satisfy ourselves that the results we get matches that
from <code>lm</code>.</p>
<pre class="r"><code>m &lt;- cbind(result$getValue(betaHat), coef(ls.model))
colnames(m) &lt;- c(&quot;CVXR est.&quot;, &quot;lm est.&quot;)
rownames(m) &lt;- paste0(&quot;$\\beta_{&quot;, 1:p, &quot;}$&quot;)
knitr::kable(m, format = &quot;html&quot;) %&gt;%
    kable_styling(&quot;striped&quot;) %&gt;%
    column_spec(1:3, background = &quot;#ececec&quot;)</code></pre>
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
CVXR est.
</th>
<th style="text-align:right;">
lm est.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{1}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
-3.9196887
</td>
<td style="text-align:right;background-color: #ececec;">
-3.9196886
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{2}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
-3.0117041
</td>
<td style="text-align:right;background-color: #ececec;">
-3.0117048
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{3}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
-2.1248257
</td>
<td style="text-align:right;background-color: #ececec;">
-2.1248242
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{4}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
-0.8666045
</td>
<td style="text-align:right;background-color: #ececec;">
-0.8666048
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{5}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
0.0914653
</td>
<td style="text-align:right;background-color: #ececec;">
0.0914658
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{6}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
0.9490453
</td>
<td style="text-align:right;background-color: #ececec;">
0.9490454
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{7}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
2.0764693
</td>
<td style="text-align:right;background-color: #ececec;">
2.0764700
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{8}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
3.1272271
</td>
<td style="text-align:right;background-color: #ececec;">
3.1272275
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{9}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
3.9609564
</td>
<td style="text-align:right;background-color: #ececec;">
3.9609565
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{10}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
5.1348848
</td>
<td style="text-align:right;background-color: #ececec;">
5.1348845
</td>
</tr>
</tbody>
</table>
</div>
<div id="wait-a-minute-what-have-we-gained" class="section level2">
<h2>Wait a minute! What have we gained?</h2>
<p>On the surface, it appears that we have replaced one call to <code>lm</code> with
at least five or six lines of new R code. On top of that, the code
actually runs slower, and so it is not clear what was really achieved.</p>
<p>So suppose we knew that the <span class="math inline">\(\beta\)</span>s were nonnegative and we wish to
take this fact into account. This
is
<a href="https://en.wikipedia.org/wiki/Non-negative_least_squares">nonnegative least squares regression</a> and
<code>lm</code> would no longer do the job.</p>
<p>In <code>CVXR</code>, the modified problem merely requires the addition of a constraint to the
problem definition.</p>
<pre class="r"><code>problem &lt;- Problem(objective, constraints = list(betaHat &gt;= 0))
result &lt;- solve(problem)
m &lt;- matrix(result$getValue(betaHat), ncol = 1)
rownames(m) &lt;- paste0(&quot;$\\beta_{&quot;, 1:p, &quot;}$&quot;)
knitr::kable(m, format = &quot;html&quot;) %&gt;%
    kable_styling(&quot;striped&quot;) %&gt;%
    column_spec(1:2, background = &quot;#ececec&quot;)</code></pre>
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{1}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{2}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{3}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{4}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{5}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
1.2374544
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{6}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
0.6234659
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{7}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
2.1230714
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{8}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
2.8035606
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{9}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
4.4448008
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{10}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
5.2073465
</td>
</tr>
</tbody>
</table>
<p>We can verify once again that these values are comparable to those
obtained from another R package,
say <a href="https://CRAN.R-project.org/package=nnls">nnls</a>.</p>
<pre class="r"><code>library(nnls)
nnls.fit &lt;- nnls(X, Y)$x</code></pre>
<pre class="r"><code>m &lt;- cbind(result$getValue(betaHat), nnls.fit)
colnames(m) &lt;- c(&quot;CVXR est.&quot;, &quot;nnls est.&quot;)
rownames(m) &lt;- paste0(&quot;$\\beta_{&quot;, 1:p, &quot;}$&quot;)
knitr::kable(m, format = &quot;html&quot;) %&gt;%
    kable_styling(&quot;striped&quot;) %&gt;%
    column_spec(1:3, background = &quot;#ececec&quot;)</code></pre>
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
CVXR est.
</th>
<th style="text-align:right;">
nnls est.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{1}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
0.0000000
</td>
<td style="text-align:right;background-color: #ececec;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{2}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
0.0000000
</td>
<td style="text-align:right;background-color: #ececec;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{3}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
0.0000000
</td>
<td style="text-align:right;background-color: #ececec;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{4}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
0.0000000
</td>
<td style="text-align:right;background-color: #ececec;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{5}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
1.2374544
</td>
<td style="text-align:right;background-color: #ececec;">
1.2374488
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{6}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
0.6234659
</td>
<td style="text-align:right;background-color: #ececec;">
0.6234665
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{7}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
2.1230714
</td>
<td style="text-align:right;background-color: #ececec;">
2.1230663
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{8}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
2.8035606
</td>
<td style="text-align:right;background-color: #ececec;">
2.8035640
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{9}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
4.4448008
</td>
<td style="text-align:right;background-color: #ececec;">
4.4448016
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{10}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
5.2073465
</td>
<td style="text-align:right;background-color: #ececec;">
5.2073521
</td>
</tr>
</tbody>
</table>
</div>
<div id="okay-that-was-cool-but" class="section level2">
<h2>Okay that was cool, but…</h2>
<p>As you no doubt noticed, we have done nothing that other R packages
could not do.</p>
<p>So now suppose further, for some extraneous reason, that the sum of
<span class="math inline">\(\beta_2\)</span> and <span class="math inline">\(\beta_3\)</span> is known to be negative and but all other
<span class="math inline">\(\beta\)</span>s are positive.</p>
<p>It is clear that this problem would not fit into any standard
package. But in <code>CVXR</code>, this is easily done by adding a few
constraints.</p>
<p>To express the fact that <span class="math inline">\(\beta_2 + \beta_3\)</span> is negative, we construct
a row matrix with zeros everywhere, except in positions 2 and 3 (for
<span class="math inline">\(\beta_2\)</span> and <span class="math inline">\(\beta_3\)</span> respectively).</p>
<pre class="r"><code>A &lt;- matrix(c(0, 1, 1, rep(0, 7)), nrow = 1)
colnames(A) &lt;- paste0(&quot;$\\beta_{&quot;, 1:p, &quot;}$&quot;)
knitr::kable(A, format = &quot;html&quot;) %&gt;%
    kable_styling(&quot;striped&quot;) %&gt;%
    column_spec(1:10, background = &quot;#ececec&quot;)</code></pre>
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
<span class="math inline">\(\beta_{1}\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\beta_{2}\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\beta_{3}\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\beta_{4}\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\beta_{5}\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\beta_{6}\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\beta_{7}\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\beta_{8}\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\beta_{9}\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\beta_{10}\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
1
</td>
<td style="text-align:right;background-color: #ececec;">
1
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
</tr>
</tbody>
</table>
<p>The sum constraint is nothing but
<span class="math display">\[
A\beta &lt; 0
\]</span></p>
<p>which we express in R as</p>
<pre class="r"><code>constraint1 &lt;- A %*% betaHat &lt; 0</code></pre>
<p><em>NOTE</em>: The above constraint can also be expressed simply as</p>
<pre class="r"><code>constraint1 &lt;- betaHat[2] + betaHat[3] &lt; 0</code></pre>
<p>but it is easier working with matrices in general with <code>CVXR</code>.</p>
<p>For the positivity for rest of the variables, we construct a <span class="math inline">\(10\times 10\)</span> matrix <span class="math inline">\(A\)</span> to have 1’s along the diagonal everywhere except rows 2
and 3 and zeros everywhere.</p>
<pre class="r"><code>B &lt;- diag(c(1, 0, 0, rep(1, 7)))
colnames(B) &lt;- rownames(B) &lt;- paste0(&quot;$\\beta_{&quot;, 1:p, &quot;}$&quot;)
knitr::kable(B, format = &quot;html&quot;) %&gt;%
    kable_styling(&quot;striped&quot;) %&gt;%
    column_spec(1:11, background = &quot;#ececec&quot;)</code></pre>
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
<span class="math inline">\(\beta_{1}\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\beta_{2}\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\beta_{3}\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\beta_{4}\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\beta_{5}\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\beta_{6}\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\beta_{7}\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\beta_{8}\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\beta_{9}\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\beta_{10}\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{1}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
1
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{2}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{3}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{4}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
1
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{5}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
1
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{6}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
1
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{7}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
1
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{8}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
1
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{9}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
1
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{10}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
0
</td>
<td style="text-align:right;background-color: #ececec;">
1
</td>
</tr>
</tbody>
</table>
<p>The constraint for positivity is
<span class="math display">\[
B\beta &gt; 0
\]</span></p>
<p>which we express in R as</p>
<pre class="r"><code>constraint2 &lt;- B %*% betaHat &gt; 0</code></pre>
<p>Now we are ready to solve the problem just as before.</p>
<pre class="r"><code>problem &lt;- Problem(objective, constraints = list(constraint1, constraint2))
result &lt;- solve(problem)</code></pre>
<p>And we can get the estimates of <span class="math inline">\(\beta\)</span>.</p>
<pre class="r"><code>m &lt;- matrix(result$getValue(betaHat), ncol = 1)
rownames(m) &lt;- paste0(&quot;$\\beta_{&quot;, 1:p, &quot;}$&quot;)
knitr::kable(m, format = &quot;html&quot;) %&gt;%
    kable_styling(&quot;striped&quot;) %&gt;%
    column_spec(1:2, background = &quot;#ececec&quot;)</code></pre>
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{1}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{2}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
-2.8447019
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{3}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
-1.7109799
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{4}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{5}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
0.6641321
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{6}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
1.1780936
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{7}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
2.3286068
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{8}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
2.4144816
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{9}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
4.2119206
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec;">
<span class="math inline">\(\beta_{10}\)</span>
</td>
<td style="text-align:right;background-color: #ececec;">
4.9483132
</td>
</tr>
</tbody>
</table>
<p>This demonstrates the chief advantage of <code>CVXR</code>: <em>flexibility</em>. Users
can quickly modify and re-solve a problem, making our package ideal
for prototyping new statistical methods. Its syntax is simple and
mathematically intuitive. Furthermore, <code>CVXR</code> combines seamlessly with
native R code as well as several popular packages, allowing it to be
incorporated easily into a larger analytical framework. The user is
free to construct statistical estimators that are solutions to a
convex optimization problem where there may not be a closed form
solution or even an implementation. Such solutions can then be
combined with resampling techniques like the bootstrap to estimate
variability.</p>
</div>
<div id="further-reading" class="section level2">
<h2>Further Reading</h2>
<p>We hope we have whet your appetite. You may wish to
read <a href="/post/examples/cvxr_gentle-intro/">a longer introduction</a>
with more examples.</p>
<p>We also have a number of <a href="/post/examples/">tutorial examples</a>
available to study and mimic.</p>
</div>
<div id="session-info" class="section level2">
<h2>Session Info</h2>
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>## R version 3.4.3 (2017-11-30)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS High Sierra 10.13.3
## 
## Matrix products: default
## BLAS: /Library/Frameworks/R.framework/Versions/3.4/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.4/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] methods   stats     graphics  grDevices datasets  utils     base     
## 
## other attached packages:
## [1] nnls_1.4         CVXR_0.95        kableExtra_0.7.0
## 
## loaded via a namespace (and not attached):
##  [1] gmp_0.5-13.1      Rcpp_0.12.15      pillar_1.1.0     
##  [4] compiler_3.4.3    plyr_1.8.4        highr_0.6        
##  [7] R.methodsS3_1.7.1 R.utils_2.6.0     tools_3.4.3      
## [10] bit_1.1-12        digest_0.6.15     evaluate_0.10.1  
## [13] tibble_1.4.2      viridisLite_0.3.0 lattice_0.20-35  
## [16] pkgconfig_2.0.1   rlang_0.2.0       Matrix_1.2-12    
## [19] yaml_2.1.16       blogdown_0.5.4    xfun_0.1         
## [22] Rmpfr_0.7-0       ECOSolveR_0.4     httr_1.3.1       
## [25] stringr_1.3.0     xml2_1.2.0        knitr_1.20       
## [28] hms_0.4.1         bit64_0.9-7       rprojroot_1.3-2  
## [31] grid_3.4.3        R6_2.2.2          rmarkdown_1.8.10 
## [34] bookdown_0.7      readr_1.1.1       magrittr_1.5     
## [37] scs_1.1-1         backports_1.1.2   scales_0.5.0     
## [40] htmltools_0.3.6   rvest_0.3.2       colorspace_1.3-2 
## [43] stringi_1.1.6     munsell_0.4.3     R.oo_1.21.0</code></pre>
</div>
<div id="source" class="section level2">
<h2>Source</h2>
<p><a href="https://github.com/bnaras/cvxr_docs/blob/master/content/post/examples/cvxr_intro.Rmd">R Markdown</a></p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
</div>
